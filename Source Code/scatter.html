<!DOCTYPE html>
<html>
<head>
    <title>Bigfoot Sightings Scatter Plot</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        .dot {
            fill: steelblue;
            stroke: black;
            stroke-width: 1px;
        }
        .tooltip {
            position: absolute;
            text-align: center;
            width: auto;
            height: auto;
            padding: 2px;
            font: 12px sans-serif;
            background: lightsteelblue;
            border: 0px;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
        }
        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
        }
        .grid {
            stroke: lightgrey;
            stroke-opacity: 0.7;
            shape-rendering: crispEdges;
        }
        .grid path {
            stroke-width: 0;
        }
    </style>
</head>
<body>
    <svg width="600" height="300"></svg>
    <div class="tooltip"></div>

    <script>
        // Load the data from the JSON file
        d3.json("bfro_subset.json").then(function(data) {
            var filteredData = data.filter(d => {
                var year = +d.Year;
                return year >= 1959 && year <= 2022 && !isNaN(year);
            });

            var sightingsByYear = d3.rollup(filteredData, v => v.length, d => d.Year);
            var dataArray = Array.from(sightingsByYear, ([Year, Sightings]) => ({Year, Sightings}));

            const svg = d3.select("svg"),
                  margin = {top: 20, right: 20, bottom: 30, left: 50},
                  width = +svg.attr("width") - margin.left - margin.right,
                  height = +svg.attr("height") - margin.top - margin.bottom,
                  g = svg.append("g").attr("transform", `translate(${margin.left},${margin.top})`);

            const xScale = d3.scaleLinear().rangeRound([0, width]).domain([1959, 2022]),
                  yScale = d3.scaleLinear().rangeRound([height, 0]).domain([0, d3.max(dataArray, d => d.Sightings)]),
                  colorScale = d3.scaleSequential(d3.interpolateBlues).domain([0, d3.max(dataArray, d => d.Sightings)]);

            const tooltip = d3.select(".tooltip");

            g.selectAll(".dot")
              .data(dataArray)
              .enter().append("circle")
              .attr("class", "dot")
              .attr("cx", d => xScale(d.Year))
              .attr("cy", d => yScale(d.Sightings))
              .attr("r", 5)
              .style("fill", d => colorScale(d.Sightings))
              .on("mouseover", function(event, d) {
                  tooltip.transition()
                         .duration(200)
                         .style("opacity", .9);
                  tooltip.html("Year: " + d.Year + "<br/>Sightings: " + d.Sightings)
                         .style("left", (event.pageX + 5) + "px")
                         .style("top", (event.pageY - 28) + "px");
              })
              .on("mouseout", function(d) {
                  tooltip.transition()
                         .duration(500)
                         .style("opacity", 0);
              });

            g.append("g")
              .attr("class", "axis axis--x")
              .attr("transform", `translate(0,${height})`)
              .call(d3.axisBottom(xScale).tickFormat(d3.format("d")));

            g.append("g")
              .attr("class", "axis axis--y")
              .call(d3.axisLeft(yScale))
              .append("text")
              .attr("transform", "rotate(-90)")
              .attr("y", 6)
              .attr("dy", "0.71em")
              .attr("text-anchor", "end")
              .text("Sightings");
        });
    </script>
</body>
</html>
